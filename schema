-- Store zero or more "private" identities for the user. These consist of
-- private and public DSA keys.
PrivIdent
    keyBackend Text -- e.g. "GPG" "openssl"
    keyID KeyID
    revoked UTCTime Maybe
    created UTCTime Maybe
    imported UTCTime Maybe
    isDefault Checkmark nullable
    UniquePrivIdentKey keyID
    UniqueDefaultKey isDefault !force

-- Store zero or more "public" identities for contacts. These are public DSA
-- keys. We keep track of whether the fingerprints have been verified.
PubIdent
    keyBackend Text
    keyID KeyID
    verified UTCTime Maybe
    revoked UTCTime Maybe
    received UTCTime
    imported UTCTime Maybe
    UniquePubIdentKey keyID

-- Mark a Jid as belonging to a pubident
PeerPubIdent
    peer Jid
    ident PubIdentId
    UniquePeerPubIdent peer

-- Store details about received revocations of public identities.
Revocation
    sessionID SessionID Maybe
    keyID Text
    date UTCTime

-- When we have signaled revocations of private identities.
RevocationSignal
    sessionID SessionID Maybe
    privIDentID KeyID

-- Sessions - authenticated key exchanges. These may be incomplete. A `Nothing'
-- value in the identity fields means that we have not revealed, or received,
-- an identity in the session.
Session
    sessionID SessionID
    privIDentID KeyID Maybe
    pubIDentID KeyID Maybe
    local Jid
    remote Jid
    date UTCTime

-- Challenges. A `Nothing' question means a query for a shared password. A
-- `Nothing' result means that a timeout occured.
Challenge
    uniqueID UUID
    peer Jid
    sessionID SessionID
    outgoing Bool
    started UTCTime Asc Desc
    completed UTCTime Maybe Eq
    question Text Maybe
    result Bool Maybe
    hidden Bool Eq
    UniqueChallenge uniqueID

HostCredentials
    hostname Text -- hostname to connect to
    username Text
    password Text
    changed UTCTime Desc
